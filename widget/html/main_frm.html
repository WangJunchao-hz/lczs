<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <script src="../script/lib/utils/rem/1.0.0/rem.js"></script>
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,initial-scale=1.0,width=device-width"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>首页</title>
    <link rel="stylesheet" type="text/css" href="../css/aui/2.1.0/aui.css"/>
    <!-- <link rel="stylesheet" type="text/css" href="../fonts/iconfont.css" />-->
    <link rel="stylesheet" type="text/css" href="http://at.alicdn.com/t/font_hdy4esq7wjqbyb9.css"/>
    <link rel="stylesheet" type="text/css" href="../css/conf/main_frm.css"/>
</head>

<body>
<div id="app" class="aui-content-padded">
    <div class="card-li bg-default">
        <div class="card-li-inner">
            <div class="fl fc-2b2525 aui-font-size-18">总资产</div>
            <div class="fr fc-1b1515 fc-bold aui-font-size-20">0.0</div>
        </div>
    </div>
    <div id="jCardList">
        <div class="card-li" v-for="item in accountLists" v-bind:class="'bg-'+ item.color" v-bind:data-id="item.id" v-bind:data-color="item.color">
            <div class="card-li-inner">
                <div class="fl fc-default">
                    <i class="iconfont fl" v-bind:class="icons[item.type]"></i>
                    <span class="name aui-ellipsis-1">{{item.name}}</span>
                    <span class="remark aui-font-size-14 fc-d7d7d7 aui-ellipsis-1">{{item.remark}}</span>
                </div>
                <div class="fr fc-default">{{item.amount}}</div>
            </div>
        </div>
    </div>
    <div class="card-li bg-default">
        <div id="jAddAccount" class="card-li-inner fc-d7d7d7 aui-font-size-16">
            <i class="iconfont icon-jia fl"></i><span>添加账户</span>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" data-main="../script/app" src="../script/lib/require/2.1.11/require.js"></script>
<!-- apiready必须放在这里才能生效 -->
<script type="text/javascript">
    apiready = function () {
        require(['common','date'],function(common,date) {
            /**
             * @description: 新建一个类
             */
            function Main() {
                this.init();
                this.initUI();
                this.events();
            }

            /**
             * @description: 初始化参数(全局变量+常量)
             */
            Main.prototype.init = function() {
                var self = this;

                //缓存全局变量
                self.title = date.periods() + '好';

                //缓存全局dom对象
                self.footerDom = $('#jFooter');
            };

            /**
             * @description: 初始化页面(首屏)
             */
            Main.prototype.initUI = function() {
                var self = this;

                var iconsArry = ['icon-xianjin','icon-yhk','icon-zfb','icon-weixin','icon-gupiao','icon-xunibi','icon-caipiao','icon-cxg','icon-licai'];
                var data = common.methods().readFile('accounts');
                self.app = new Vue({
                    el: '#app',
                    data: {
                        accountLists: data.contents,
                        icons:iconsArry
                    }
                });
            };

            /**
             * @description: 事件管理
             */
            Main.prototype.events = function() {
                var self = this;

                api.addEventListener({
                    name: 'addAccountSuccess'
                }, function(ret, err){
                    var data = common.methods().readFile('accounts');
                    self.app.accountLists = data.contents;
                });
                
                $('#jCardList').on('click','.card-li',function () {
                    var id = $(this).attr('data-id');
                    var name = $(this).find('.name').text();
                    var color = $(this).attr('data-color');
                    common.methods().openWin('accountDetail','./accounts/accountDetail.html',{
                        id:id,
                        name:name,
                        color:color
                    });
                });
                
                $('#jAddAccount').click(function () {
                    api.openWin({
                        name: 'add',
                        url: './accounts/add.html',
                        delay: delay,
                        bounces: false,
                        pageParam: {
                            type:'1'
                        },
                        animation:{
                            type:'fade'
                        }
                    });
                });
            };

            /**
             * @description: ajax管理
             */
            Main.prototype.https = function() {
                var self = this;
                return {

                };
            };

            /**
             * @description: 方法管理
             */
            Main.prototype.methods = function() {
                var self = this;
                return {

                };
            };

            new Main();
        });
    };
</script>

</html>
